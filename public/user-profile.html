<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Profile and Dashboard - VeLinked</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="css/profile.css">
    <link rel="shortcut icon" href="assets/images/icon.svg" type="image/x-icon">
    <!-- Firebase SDKs -->
    <script defer src="/__/firebase/10.9.0/firebase-app-compat.js"></script>
    <script defer src="/__/firebase/10.9.0/firebase-auth-compat.js"></script>
    <script defer src="/__/firebase/10.9.0/firebase-database-compat.js"></script>
    <script defer src="/__/firebase/10.9.0/firebase-firestore-compat.js"></script>
    <script defer src="/__/firebase/10.9.0/firebase-functions-compat.js"></script>
    <script defer src="/__/firebase/10.9.0/firebase-messaging-compat.js"></script>
    <script defer src="/__/firebase/10.9.0/firebase-storage-compat.js"></script>
    <script defer src="/__/firebase/10.9.0/firebase-analytics-compat.js"></script>
    <script defer src="/__/firebase/10.9.0/firebase-remote-config-compat.js"></script>
    <script defer src="/__/firebase/10.9.0/firebase-performance-compat.js"></script>
    <script defer src="/__/firebase/init.js?useEmulator=true"></script>
</head>
<body>
    <div class="container rounded bg-white mt-5 mb-5">
        <button class="btn btn-primary mt-2" onclick="window.location.href = 'admin.html'">
            <i class="fas fa-arrow-left"></i>  Back
          </button>
        <div class="row">
            <div class="col-md-3 border-right">
                <div class="d-flex flex-column align-items-center text-center p-3 py-5">
                    <img class="rounded-circle mt-10" width="150px" src="" id="profile-pic">
                    <span class="font-weight-bold" id="user-name"></span>
                    <span class="text-black-50" id="user-email"></span>
                    <span> </span>
                </div>
            </div>
            <div class="col-md-5 border-right">
                <div class="p-3 py-5">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h4 class="text-right">Profile Settings</h4>
                    </div>
                    <div class="row mt-3">
                        <div class="col-md-12">
                            <label class="labels">Mobile Number :</label>
                            <span id="phone"></span>
                        </div>
                        <div class="col-md-12">
                            <label class="labels">Address :</label>
                            <span id="address"></span>
                        </div>
                    </div>
                    
                </div>
            </div> 
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Ambil UID pengguna dari parameter URL
            const urlParams = new URLSearchParams(window.location.search);
            const userId = urlParams.get('userId');

            // Pastikan UID pengguna tersedia
            if (userId) {
                // Ambil data pengguna dari Firestore berdasarkan UID
                firebase.firestore().collection("users").doc(userId).get()
                    .then(doc => {
                        if (doc.exists) {
                            const userData = doc.data();
                            // Update profile picture, name, email, phone number, and address in the HTML
                            document.getElementById("profile-pic").src = userData.photoURL;
                            document.getElementById("user-name").innerText = userData.displayName;
                            document.getElementById("user-email").innerText = userData.email;
                            const phone = userData.phone ? userData.phone : "Phone number not available";
                            const address = userData.address ? userData.address : "Address not available";
                            document.getElementById("phone").innerText = phone;
                            document.getElementById("address").innerText = address;
                        } else {
                            console.log("No such document!");
                        }
                    })
                    .catch(error => {
                        console.error("Error getting user data:", error);
                        // Beri respons kepada pengguna jika terjadi kesalahan
                    });
            } else {
                // Jika UID pengguna tidak tersedia dalam parameter URL, arahkan kembali ke halaman sebelumnya
                window.history.back();
            }
        });
    </script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-analytics.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyB9qUzLViR5uALw9Qf_xzJpd20acoV0FEs",
            authDomain: "velinked-web.firebaseapp.com",
            projectId: "velinked-web",
            storageBucket: "velinked-web.appspot.com",
            messagingSenderId: "844821073092",
            appId: "1:844821073092:web:f243c25668079240ec0d91",
            measurementId: "G-CLGQ4RWWTX"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
    </script>
</body>
</html>
